<html>
<head>
<title>~/Dev/Code/J2EE/GTD-MCC/src/org/localstorm/mcc/ejb/AbstractSingletonManager.java.html</title>
<meta name="Generator" content="Vim/7.0">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#ff40ff">package</font> org.localstorm.mcc.ejb;

<font color="#ff40ff">import</font> javax.persistence.EntityManager;
<font color="#ff40ff">import</font> javax.persistence.PersistenceContext;

<font color="#8080ff">/**</font>
<font color="#8080ff"> *</font>
<font color="#8080ff"> </font><font color="#8080ff">* </font><font color="#ff40ff">@author</font><font color="#8080ff"> Alexey Kuznetsov</font>
<font color="#8080ff"> */</font>
<font color="#00ff00">public</font> <font color="#00ff00">abstract</font> <font color="#00ff00">class</font> AbstractSingletonManager &lt;T <font color="#00ff00">extends</font> Identifiable &amp; Retireable, E&gt;
                                               <font color="#00ff00">implements</font> BaseSingletonManager&lt;T, E&gt;
{
    <font color="#00ff00">protected</font> <font color="#00ff00">abstract</font> T createNewCurrent(E owner);

    <font color="#00ff00">public</font> AbstractSingletonManager(Class&lt;T&gt; c) {
        <font color="#00ff00">this</font>.cl = c;
    }

    <font color="#ff40ff">@Override</font>
    <font color="#00ff00">public</font> <font color="#00ff00">void</font> update( T o )
    {
        em.merge( o );
    }

    <font color="#ff40ff">@Override</font>
    <font color="#00ff00">public</font> <font color="#00ff00">void</font> utilizeCurrent( E e ) {
        T current = <font color="#00ff00">this</font>.findCurrent(e);
        current.setArchived(<font color="#ff6060">true</font>);
        <font color="#00ff00">this</font>.update(current);
        <font color="#00ff00">this</font>.createNewCurrent( e );
    }


    <font color="#ff40ff">@PersistenceContext</font>(unitName=Constants.DEFAULT_PU)
    <font color="#00ff00">protected</font> EntityManager em;

    <font color="#00ff00">private</font> Class&lt;T&gt; cl;
}
</pre>
</body>
</html>
